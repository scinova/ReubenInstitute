{% if request.environ.HTTP_HOST == 'localhost:5000' %}
	{% extends "base-standalone.html" %}
{% else %}
	{% extends "base.html" %}
{% endif %}
{% block title %}{% endblock %}
{% block content %}
<h1>{{article.title}}</h1>
{% for section_idx in range(article.sections|length) %}
	{% if request.environ.HTTP_HOST == '127.0.0.1:5000' %}
	<a href="/zohar/{{article.book.number}}/{{article.chapter.number}}/{{article.number}}/edit/{{loop.index}}">edit</a><br />
	{% endif %}
	<a id="v{{loop.index}}"></a>
	<div class="section">
		<div class="right justify">
			{% for line in article.sections[section_idx] %}
				{%- for span in article.parse(line) -%}
					{%- if span.kind == SpanKind.SYNONYM -%}
						<span class="synonym">(={{span.value}})</span>
					{%- elif span.kind == SpanKind.EXPLANATION -%}
						<span class="explanation"">(~{{span.value}})</span>
					{%- elif span.kind == SpanKind.CORRECTION -%}
						<span class="correction">[{{span.value}}]</span>
					{%- elif span.kind == SpanKind.CITATION -%}
						<span class="citation">“{{span.value}}”</span>
					{%- elif span.kind == SpanKind.ALTERNATIVE -%}
						<span class="alternative">{{span.value}}</span>
					{%- elif span.kind == SpanKind.PLAIN -%}
						<span class="plain">{{re.sub('\[([^]]+)\]', '<span class="silent">\\1</span>', aramaic.spell(span.value))|safe}}</span>
					{%- endif -%}
				{%- endfor -%}
				<br />
			{% endfor %}
		</div>
		<div class="left justify">
			{% for line in article.translation_sections[section_idx] %}
				{%- for span in article.parse(line) -%}
					{%- if span.kind == SpanKind.SYNONYM -%}
						<span class="synonym">(={{span.value}})</span>
					{%- elif span.kind == SpanKind.EXPLANATION -%}
						<span class="explanation"">(~{{span.value}})</span>
					{%- elif span.kind == SpanKind.CORRECTION -%}
						<span class="correction">[{{span.value}}]</span>
					{%- elif span.kind == SpanKind.CITATION -%}
						<span class="citation">“{{span.value}}”</span>
					{%- elif span.kind == SpanKind.LINK -%}
						<span class="link">{{span.value}}</span>
					{%- elif span.kind == SpanKind.ALTERNATIVE -%}
						<span class="alternative">{{span.value}}</span>
					{%- elif span.kind == SpanKind.PLAIN -%}
						<span class="plain">{{span.value}}</span>
					{%- endif -%}
				{%- endfor -%}
				<br />
			{% endfor %}
		</div>
		<div class="clear"></div>
	</div><br />
{% endfor %}
{% endblock %}
